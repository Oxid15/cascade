<!DOCTYPE html>


<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Pipeline building &#8212; cascade 0.11.1 documentation</title>



    <script data-cfasync="false">
        document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
        document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
    </script>

    <!-- Loaded before other Sphinx assets -->
    <link href="../styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
    <link href="../styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
    <link href="../styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />


    <link href="../vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
    <link rel="preload" as="font" type="font/woff2" crossorigin
        href="../vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
    <link rel="preload" as="font" type="font/woff2" crossorigin
        href="../vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
    <link rel="preload" as="font" type="font/woff2" crossorigin
        href="../vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../pygments.css" />
    <link rel="stylesheet" type="text/css" href="../styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../nbsphinx-code-cells.css" />

    <!-- Pre-loaded scripts that we'll load fully later -->
    <link rel="preload" as="script" href="../scripts/bootstrap.js?digest=e353d410970836974a52" />
    <link rel="preload" as="script" href="../scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../documentation_options.js"></script>
    <script src="../jquery.js"></script>
    <script src="../underscore.js"></script>
    <script src="../doctools.js"></script>
    <script src="../clipboard.min.js"></script>
    <script src="../copybutton.js"></script>
    <script src="../design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA="
        src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = { "tex": { "inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true }, "options": { "ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area" } }</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/pipeline_building';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://oxid15.github.io/cascade/en/latest/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v0.11.1';
    </script>
    <link rel="shortcut icon" href="../100x100_logo.png" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model training" href="model_training.html" />
    <link rel="prev" title="Dataset Zoo" href="dataset_zoo.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None" />
</head>


<body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%"
    data-default-mode="">



    <a class="skip-link" href="#main-content">Skip to main content</a>

    <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary" />
    <label class="overlay overlay-primary" for="__primary"></label>

    <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary" />
    <label class="overlay overlay-secondary" for="__secondary"></label>

    <div class="search-button__wrapper">
        <div class="search-button__overlay"></div>
        <div class="search-button__search-container">
            <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..."
                    aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off"
                    spellcheck="false" />
                <span class="search-button__kbd-shortcut"><kbd
                        class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
            </form>
        </div>
    </div>

    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
        <div class="bd-header__inner bd-page-width">
            <label class="sidebar-toggle primary-toggle" for="__primary">
                <span class="fa-solid fa-bars"></span>
            </label>

            <div class="navbar-header-items__start">

                <div class="navbar-item">


                    <a class="navbar-brand logo" href="../index.html">









                        <img src="../logo.png" class="logo__image only-light" alt="Logo image" />
                        <script>document.write(`<img src="../logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>


                    </a>
                </div>

                <div class="navbar-item">
                    <script>
                        document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      latest  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
                    </script>
                </div>

            </div>


            <div class="col-lg-9 navbar-header-items">

                <div class="me-auto navbar-header-items__center">

                    <div class="navbar-item">
                        <nav class="navbar-nav">
                            <p class="sidebar-header-items__title" role="heading" aria-level="1"
                                aria-label="Site Navigation">
                                Site Navigation
                            </p>
                            <ul class="bd-navbar-elements navbar-nav">

                                <li class="nav-item current active">
                                    <a class="nav-link nav-internal" href="../quickstart.html">
                                        Quickstart
                                    </a>
                                </li>


                                <li class="nav-item">
                                    <a class="nav-link nav-internal" href="../concepts.html">
                                        Concepts
                                    </a>
                                </li>


                                <li class="nav-item">
                                    <a class="nav-link nav-internal" href="../modules.html">
                                        Cascade modules reference
                                    </a>
                                </li>

                            </ul>
                        </nav>
                    </div>

                </div>


                <div class="navbar-header-items__end">

                    <div class="navbar-item navbar-persistent--container">

                        <script>
                            document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
                        </script>
                    </div>


                    <div class="navbar-item">
                        <script>
                            document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
                        </script>
                    </div>

                    <div class="navbar-item">
                        <ul class="navbar-icon-links navbar-nav" aria-label="Icon Links">
                            <li class="nav-item">








                                <a href="https://github.com/oxid15/cascade" title="GitHub" class="nav-link"
                                    rel="noopener" target="_blank" data-bs-toggle="tooltip"
                                    data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
                                    <label class="sr-only">GitHub</label></a>
                            </li>
                        </ul>
                    </div>

                </div>

            </div>


            <div class="navbar-persistent--mobile">
                <script>
                    document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
                </script>
            </div>



            <label class="sidebar-toggle secondary-toggle" for="__secondary">
                <span class="fa-solid fa-outdent"></span>
            </label>

        </div>

    </nav>

    <div class="bd-container">
        <div class="bd-container__inner bd-page-width">

            <div class="bd-sidebar-primary bd-sidebar">



                <div class="sidebar-header-items sidebar-primary__section">


                    <div class="sidebar-header-items__center">

                        <div class="navbar-item">
                            <nav class="navbar-nav">
                                <p class="sidebar-header-items__title" role="heading" aria-level="1"
                                    aria-label="Site Navigation">
                                    Site Navigation
                                </p>
                                <ul class="bd-navbar-elements navbar-nav">

                                    <li class="nav-item current active">
                                        <a class="nav-link nav-internal" href="../quickstart.html">
                                            Quickstart
                                        </a>
                                    </li>


                                    <li class="nav-item">
                                        <a class="nav-link nav-internal" href="../concepts.html">
                                            Concepts
                                        </a>
                                    </li>


                                    <li class="nav-item">
                                        <a class="nav-link nav-internal" href="../modules.html">
                                            Cascade modules reference
                                        </a>
                                    </li>

                                </ul>
                            </nav>
                        </div>

                    </div>



                    <div class="sidebar-header-items__end">

                        <div class="navbar-item">
                            <script>
                                document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
                            </script>
                        </div>

                        <div class="navbar-item">
                            <ul class="navbar-icon-links navbar-nav" aria-label="Icon Links">
                                <li class="nav-item">








                                    <a href="https://github.com/oxid15/cascade" title="GitHub" class="nav-link"
                                        rel="noopener" target="_blank" data-bs-toggle="tooltip"
                                        data-bs-placement="bottom"><span><i class="fa-brands fa-github"></i></span>
                                        <label class="sr-only">GitHub</label></a>
                                </li>
                            </ul>
                        </div>

                    </div>

                </div>

                <div class="sidebar-primary-items__start sidebar-primary__section">
                    <div class="sidebar-primary-item">
                        <nav class="bd-docs-nav bd-links" aria-label="Section Navigation">
                            <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
                            <div class="bd-toc-item navbar-nav">
                                <ul class="current nav bd-sidenav">
                                    <li class="toctree-l1"><a class="reference internal" href="dataset_zoo.html">Dataset
                                            Zoo</a></li>
                                    <li class="toctree-l1 current active"><a class="current reference internal"
                                            href="#">Pipeline building</a></li>
                                    <li class="toctree-l1"><a class="reference internal"
                                            href="model_training.html">Model training</a></li>
                                    <li class="toctree-l1"><a class="reference internal"
                                            href="model_training_trainers.html">Model training using trainers</a></li>
                                    <li class="toctree-l1"><a class="reference internal"
                                            href="data_validation.html">Data validation</a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>


                <div class="sidebar-primary-items__end sidebar-primary__section">
                </div>

                <div id="rtd-footer-container"></div>


            </div>

            <main id="main-content" class="bd-main">


                <div class="bd-content">
                    <div class="bd-article-container">

                        <div class="bd-header-article">
                            <div class="header-article-items header-article__inner">

                                <div class="header-article-items__start">

                                    <div class="header-article-item">



                                        <nav aria-label="Breadcrumbs">
                                            <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">

                                                <li class="breadcrumb-item breadcrumb-home">
                                                    <a href="../index.html" class="nav-link" aria-label="Home">
                                                        <i class="fa-solid fa-home"></i>
                                                    </a>
                                                </li>

                                                <li class="breadcrumb-item"><a href="../quickstart.html"
                                                        class="nav-link">Quickstart</a></li>

                                                <li class="breadcrumb-item active" aria-current="page">Pipeline building
                                                </li>
                                            </ul>
                                        </nav>
                                    </div>

                                </div>


                            </div>
                        </div>




                        <div id="searchbox"></div>
                        <article class="bd-article" role="main">

                            <section id="Pipeline-building">
                                <h1>Pipeline building<a class="headerlink" href="#Pipeline-building"
                                        title="Permalink to this headline">#</a></h1>
                                <p>This use-case is pipeline building. For this example the task of classification on
                                    MNIST is used.</p>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight">
                                            <pre><span></span>[1]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="ch">#!pip3 install torchvision</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nbinput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight">
                                            <pre><span></span>[2]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="kn">import</span> <span class="nn">cascade.data</span> <span class="k">as</span> <span class="nn">cdd</span>
<span class="kn">import</span> <span class="nn">cascade.meta</span> <span class="k">as</span> <span class="nn">cme</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">import</span> <span class="nn">torchvision.transforms.functional</span> <span class="k">as</span> <span class="nn">F</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nbinput docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight">
                                            <pre><span></span>[3]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="kn">import</span> <span class="nn">cascade</span>
<span class="n">cascade</span><span class="o">.</span><span class="n">__version__</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput nblast docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight">
                                            <pre><span></span>[3]:
</pre>
                                        </div>
                                    </div>
                                    <div class="output_area docutils container">
                                        <div class="highlight">
                                            <pre>
&#39;0.11.0&#39;
</pre>
                                        </div>
                                    </div>
                                </div>
                                <p>Let’s load torch dataset</p>
                                <div class="nbinput docutils container">
                                    <div class="prompt highlight-none notranslate">
                                        <div class="highlight">
                                            <pre><span></span>[4]:
</pre>
                                        </div>
                                    </div>
                                    <div class="input_area highlight-ipython3 notranslate">
                                        <div class="highlight">
                                            <pre><span></span><span class="n">MNIST_ROOT</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span>

<span class="n">train_ds</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">MNIST_ROOT</span><span class="p">,</span>
                                     <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">transform</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">,</span>
                                     <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">MNIST_ROOT</span><span class="p">,</span>
                                    <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">transform</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">to_tensor</span><span class="p">)</span>
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <div class="highlight">
                                            <pre>
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to data/MNIST/raw/train-images-idx3-ubyte.gz
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <script
                                            type="application/vnd.jupyter.widget-view+json">{"model_id": "c7815f82b75540f184fceb59416f379a", "version_major": 2, "version_minor": 0}</script>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <div class="highlight">
                                            <pre>
Extracting data/MNIST/raw/train-images-idx3-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to data/MNIST/raw/train-labels-idx1-ubyte.gz
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <script
                                            type="application/vnd.jupyter.widget-view+json">{"model_id": "0f0b5ce391e442a29e370f8a0c5e8d48", "version_major": 2, "version_minor": 0}</script>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <div class="highlight">
                                            <pre>
Extracting data/MNIST/raw/train-labels-idx1-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to data/MNIST/raw/t10k-images-idx3-ubyte.gz
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <script
                                            type="application/vnd.jupyter.widget-view+json">{"model_id": "daf752b5b5f24750aeae1594dccc7433", "version_major": 2, "version_minor": 0}</script>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <div class="highlight">
                                            <pre>
Extracting data/MNIST/raw/t10k-images-idx3-ubyte.gz to data/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to data/MNIST/raw/t10k-labels-idx1-ubyte.gz
</pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="nboutput docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <script
                                            type="application/vnd.jupyter.widget-view+json">{"model_id": "4dde1ebd979940b582f9d7907597144d", "version_major": 2, "version_minor": 0}</script>
                                    </div>
                                </div>
                                <div class="nboutput nblast docutils container">
                                    <div class="prompt empty docutils container">
                                    </div>
                                    <div class="output_area docutils container">
                                        <div class="highlight">
                                            <pre>
Extracting data/MNIST/raw/t10k-labels-idx1-ubyte.gz to data/MNIST/raw

</pre>
                                        </div>
                                    </div>
                                </div>
                                <section id="Adding-metadata">
                                    <h2>Adding metadata<a class="headerlink" href="#Adding-metadata"
                                            title="Permalink to this headline">#</a></h2>
                                    <p>But in the end we need not only loaded dataset, but the container for metadata we
                                        can store. So the next step is to link these datasets to Cascade’s objects. The
                                        most simple way is to use <code
                                            class="docutils literal notranslate"><span class="pre">cascade.data.Wrapper</span></code>.
                                    </p>
                                    <div class="line-block">
                                        <div class="line">Suppose we also need to write some data description to be able
                                            to know on which data our model was trained. We can do it using <code
                                                class="docutils literal notranslate"><span class="pre">meta_prefix</span></code>
                                            keyword in the constructor of any dataset.</div>
                                        <div class="line">It accepts python dictionaries of any serializable objects. We
                                            will pass short description in metadata.</div>
                                    </div>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[5]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="n">train_ds</span> <span class="o">=</span> <span class="n">cdd</span><span class="o">.</span><span class="n">Wrapper</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span>
    <span class="n">meta_prefix</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;desc&#39;</span><span class="p">:</span> <span class="s1">&#39;This is MNIST dataset of handwritten images&#39;</span>
    <span class="p">})</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">cdd</span><span class="o">.</span><span class="n">Wrapper</span><span class="p">(</span><span class="n">test_ds</span><span class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section id="Applying-noise">
                                    <h2>Applying noise<a class="headerlink" href="#Applying-noise"
                                            title="Permalink to this headline">#</a></h2>
                                    <div class="line-block">
                                        <div class="line">Let’s say we want to apply noise to an image.</div>
                                        <div class="line"><em>We will use hardcoded magnitude to simplify an
                                                example.</em></div>
                                        <div class="line">To do this we need to make a Modifier. Modifier wraps another
                                            dataset and applies a function to its elements in a lazy way.</div>
                                    </div>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[6]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="k">class</span> <span class="nc">NoiseModifier</span><span class="p">(</span><span class="n">cdd</span><span class="o">.</span><span class="n">Modifier</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">img</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="c1"># get the data from Wrapper, which is _dataset for this Modifier</span>
        <span class="n">img</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="c1"># apply random noise with fixed magnitude</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">img</span><span class="p">,</span> <span class="n">label</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[7]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="c1"># Let&#39;s apply the noise to the images!</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">NoiseModifier</span><span class="p">(</span><span class="n">train_ds</span><span class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section id="Validation">
                                    <h2>Validation<a class="headerlink" href="#Validation"
                                            title="Permalink to this headline">#</a></h2>
                                    <p>Data validation is one of the most important parts of any ML-pipeline. Testing
                                        some assumtions is useful when our pipeline is very complex, but here let’s add
                                        validation stage just for demonstration.</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[8]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="n">cme</span><span class="o">.</span><span class="n">PredicateValidator</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">))</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area stderr docutils container">
                                            <div class="highlight">
                                                <pre>

</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight">
                                                <pre>
OK!
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area stderr docutils container">
                                            <div class="highlight">
                                                <pre>

</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[8]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight">
                                                <pre>
cascade.meta.validator.PredicateValidator
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section id="Versioning">
                                    <h2>Versioning<a class="headerlink" href="#Versioning"
                                            title="Permalink to this headline">#</a></h2>
                                    <p>For tracking changes in the pipeline during the experiments, the version could be
                                        used.</p>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[9]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="n">cdd</span><span class="o">.</span><span class="n">VersionAssigner</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="s1">&#39;./train_ds_version_log.yml&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput docutils container">
                                        <div class="prompt empty docutils container">
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight">
                                                <pre>
Dataset version: 0.0
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[9]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight">
                                                <pre>
cascade.data.version_assigner.VersionAssigner
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section id="Viewing-metadata">
                                    <h2>Viewing metadata<a class="headerlink" href="#Viewing-metadata"
                                            title="Permalink to this headline">#</a></h2>
                                    <div class="line-block">
                                        <div class="line">To view final metadata of the pipeline we can see what <code
                                                class="docutils literal notranslate"><span class="pre">get_meta</span></code>
                                            method gives:</div>
                                        <div class="line">It is the list of dicts with metadata of each block. First is
                                            NoiseModifier and the second is Wrapper around MNIST Dataset with our custom
                                            description.</div>
                                        <div class="line">Using keyword <code
                                                class="docutils literal notranslate"><span class="pre">meta_prefix</span></code>
                                            and method <code
                                                class="docutils literal notranslate"><span class="pre">update_meta</span></code>
                                            we can add any info we want to the object’s metadata.</div>
                                    </div>
                                    <div class="nbinput docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[10]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="n">train_ds</span><span class="o">.</span><span class="n">get_meta</span><span class="p">()</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nboutput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[10]:
</pre>
                                            </div>
                                        </div>
                                        <div class="output_area docutils container">
                                            <div class="highlight">
                                                <pre>
[{&#39;name&#39;: &#39;__main__.NoiseModifier&#39;, &#39;type&#39;: &#39;dataset&#39;, &#39;len&#39;: 60000},
 {&#39;name&#39;: &#39;cascade.data.dataset.Wrapper&#39;,
  &#39;desc&#39;: &#39;This is MNIST dataset of handwritten images&#39;,
  &#39;type&#39;: &#39;dataset&#39;,
  &#39;len&#39;: 60000,
  &#39;obj_type&#39;: &#34;&lt;class &#39;torchvision.datasets.mnist.MNIST&#39;&gt;&#34;}]
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section id="Ready-to-train-model">
                                    <h2>Ready to train model<a class="headerlink" href="#Ready-to-train-model"
                                            title="Permalink to this headline">#</a></h2>
                                    <p>Now we can set the batch size and pass our pipeline to the DataLoaders.</p>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[11]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">10</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nbinput nblast docutils container">
                                        <div class="prompt highlight-none notranslate">
                                            <div class="highlight">
                                                <pre><span></span>[12]:
</pre>
                                            </div>
                                        </div>
                                        <div class="input_area highlight-ipython3 notranslate">
                                            <div class="highlight">
                                                <pre><span></span><span class="n">trainldr</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span>
                                       <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
                                       <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">testldr</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">test_ds</span><span class="p">,</span>
                                      <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
                                      <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section id="See-also:">
                                    <h2>See also:<a class="headerlink" href="#See-also:"
                                            title="Permalink to this headline">#</a></h2>
                                    <p><a class="reference external" href="model_training.html">Train models</a></p>
                                </section>
                            </section>


                        </article>



                        <footer class="bd-footer-article">

                            <div class="footer-article-items footer-article__inner">

                                <div class="footer-article-item"><!-- Previous / next buttons -->
                                    <div class="prev-next-area">
                                        <a class="left-prev" href="dataset_zoo.html" title="previous page">
                                            <i class="fa-solid fa-angle-left"></i>
                                            <div class="prev-next-info">
                                                <p class="prev-next-subtitle">previous</p>
                                                <p class="prev-next-title">Dataset Zoo</p>
                                            </div>
                                        </a>
                                        <a class="right-next" href="model_training.html" title="next page">
                                            <div class="prev-next-info">
                                                <p class="prev-next-subtitle">next</p>
                                                <p class="prev-next-title">Model training</p>
                                            </div>
                                            <i class="fa-solid fa-angle-right"></i>
                                        </a>
                                    </div>
                                </div>

                            </div>

                        </footer>

                    </div>



                    <div class="bd-sidebar-secondary bd-toc">
                        <div class="sidebar-secondary-items sidebar-secondary__inner">

                            <div class="sidebar-secondary-item">
                                <div class="page-toc tocsection onthispage">
                                    <i class="fa-solid fa-list"></i> On this page
                                </div>
                                <nav class="bd-toc-nav page-toc">
                                    <ul class="visible nav section-nav flex-column">
                                        <li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"
                                                href="#Adding-metadata">Adding metadata</a></li>
                                        <li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"
                                                href="#Applying-noise">Applying noise</a></li>
                                        <li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"
                                                href="#Validation">Validation</a></li>
                                        <li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"
                                                href="#Versioning">Versioning</a></li>
                                        <li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"
                                                href="#Viewing-metadata">Viewing metadata</a></li>
                                        <li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"
                                                href="#Ready-to-train-model">Ready to train model</a></li>
                                        <li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link"
                                                href="#See-also:">See also:</a></li>
                                    </ul>
                                </nav>
                            </div>

                            <div class="sidebar-secondary-item">
                                <div class="tocsection sourcelink">
                                    <a href="../_sources/examples/pipeline_building.ipynb.txt">
                                        <i class="fa-solid fa-file-lines"></i> Show Source
                                    </a>
                                </div>
                            </div>

                        </div>
                    </div>


                </div>
                <footer class="bd-footer-content">

                </footer>

            </main>
        </div>
    </div>

    <!-- Scripts loaded after <body> so the DOM is not blocked -->
    <script src="../scripts/bootstrap.js?digest=e353d410970836974a52"></script>
    <script src="../scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

    <footer class="bd-footer">
        <div class="bd-footer__inner bd-page-width">

            <div class="footer-items__start">

                <div class="footer-item">
                    <p class="copyright">

                        © Copyright 2022-2023, Ilia Moiseev.
                        <br />

                    </p>
                </div>

                <div class="footer-item">
                    <p class="sphinx-version">
                        Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
                        <br />
                    </p>
                </div>

            </div>


            <div class="footer-items__end">

                <div class="footer-item">
                    <p class="theme-version">
                        Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData
                            Sphinx Theme</a> 0.13.3.
                    </p>
                </div>

            </div>

        </div>

    </footer>
</body>

</html>